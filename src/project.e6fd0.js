window.__require=function e(t,n,o){function i(a,c){if(!n[a]){if(!t[a]){var u=a.split("/");if(u=u[u.length-1],!t[u]){var s="function"==typeof __require&&__require;if(!c&&s)return s(u,!0);if(r)return r(u,!0);throw new Error("Cannot find module '"+a+"'")}}var l=n[a]={exports:{}};t[a][0].call(l.exports,function(e){return i(t[a][1][e]||e)},l,l.exports,e,t,n,o)}return n[a].exports}for(var r="function"==typeof __require&&__require,a=0;a<o.length;a++)i(o[a]);return i}({BlockSpritePrefab:[function(e,t,n){"use strict";cc._RF.push(t,"ddcdavOVO5FDrpf678LmrIR","BlockSpritePrefab");var o=e("GameUtil");cc.Class({extends:cc.Component,properties:{NumberSpriteFrame:{default:[],type:cc.SpriteFrame},DesignSpriteFrame:{default:[],type:cc.SpriteFrame},BgSpriteFrame:{default:[],type:cc.SpriteFrame},BgSprite:cc.Sprite,NumberSprite:cc.Sprite,idName:cc.Integer,idIndex:cc.Integer},start:function(){window.ga=this,ga.SoundMgr=e("SoundMgr").getInstance()},setIdName:function(e){this.idName=e},setIdIndex:function(e){this.index=e},setBlockFrame:function(e,t){this.NumberSprite.spriteFrame="shuzi"==t?this.NumberSpriteFrame[e]:"tuan"==t?this.DesignSpriteFrame[e]:""},setBGFrame:function(e){this.BgSprite.spriteFrame=this.BgSpriteFrame[e]},onCollisionStay:function(e,t){if("shuzi"!=e.node.group){o.istouch||t.node.x==e.node.x||t.node.y==e.node.y||e.node.getComponent("BlockSpritePrefab").idName!=t.node.getComponent("BlockSpritePrefab").idName?!o.istouch&&t.node.x!=e.node.x&&t.node.y!=e.node.y&&(e.node.getComponent("BlockSpritePrefab").idName,t.node.getComponent("BlockSpritePrefab").idName):(console.log("on collision enter"),t.node.x=e.node.x,t.node.y=e.node.y);var n=t.world;n.aabb,n.preAabb,n.transform,n.radius,n.position,n.points}}}),cc._RF.pop()},{GameUtil:"GameUtil",SoundMgr:"SoundMgr"}],GameUtil:[function(e,t,n){"use strict";cc._RF.push(t,"eaa272am8JFoLEmX5hsXbuW","GameUtil");var o={istouch:!1,gameErrorTimes:0,getRandomArrayElements:function(e,t){for(var n,o,i=e.slice(0),r=e.length,a=r-t;r-- >a;)n=i[o=Math.floor((r+1)*Math.random())],i[o]=i[r],i[r]=n;return i.slice(a)},randomArraySort:function(e){return e.sort(function(e,t){return Math.random()>.5?-1:1})}};t.exports=o,cc._RF.pop()},{}],Grobal:[function(e,t,n){"use strict";cc._RF.push(t,"52b87KXQVVFfaQzynf2GeEr","Grobal"),window.Grobal={mainScene:null},cc._RF.pop()},{}],LoadingLayer:[function(e,t,n){"use strict";cc._RF.push(t,"831bbALJihKlqTbnLjY+Y9g","LoadingLayer"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){},start:function(){}}),cc._RF.pop()},{}],MainScene:[function(e,t,n){"use strict";cc._RF.push(t,"b1bfbwkoUhElo6kdINgjtdB","MainScene");var o=e("GameUtil"),i=e("child-mitt-plugin");cc.Class({extends:cc.Component,properties:{BlockPrefab:cc.Prefab,GameLayer:cc.Node,StartGameLayer:cc.Node},ctor:function(){},onLoad:function(){var t=this;this.gameVolume=.5,this.plugin=new i({onInit:function(e){t.gameRestart()},onRestart:function(){t.gameRestart()},onPause:function(){t.gamePause()},onResume:function(){t.gameResume()},onVolumeChange:function(e){t.volumeChamge(e.volume)},onHint:function(){t.gameHint()}}),cc.director.getCollisionManager().enabled=!0,Grobal.mainScene=this,window.ga=this,ga.SoundMgr=e("SoundMgr").getInstance(),this.amountArray=[0,1,2,3,4,5,6,7,8,9],this.DesignArray=[];for(var n=0;n<4;n++){var o=cc.instantiate(this.BlockPrefab),r=o.width,a=o.height;o.getComponent("BlockSpritePrefab").setBGFrame(0),o.getComponent("BlockSpritePrefab").setBlockFrame(n,"tuan"),this.GameLayer.addChild(o),o.setPosition(96+96*n+(r*n+r/2)+60,this.GameLayer.height-72-a/2),this.DesignArray[n]=o}this.DottedArray=[],this.DottedPosArray=[];for(var c=0;c<4;c++){var u=cc.instantiate(this.BlockPrefab),s=u.width,l=u.height;u.group="xuxian",u.getComponent("BlockSpritePrefab").setBGFrame(1),u.getComponent("BlockSpritePrefab").setBlockFrame(c,"bg"),this.GameLayer.addChild(u),u.setPosition(96+96*c+(s*c+s/2)+60,this.GameLayer.height-72-1.5*l),this.DottedArray[c]=u}this.NumberArray=[],this.NumberPosArray=[];for(var d=0;d<4;d++){var f=cc.instantiate(this.BlockPrefab),m=f.width,p=f.height;f.group="shuzi",f.getComponent("BlockSpritePrefab").setBGFrame(0),f.getComponent("BlockSpritePrefab").setBlockFrame(d,"shuzi"),f.getComponent("BlockSpritePrefab").setIdIndex(d),this.GameLayer.addChild(f),f.setPosition(96+96*d+(m*d+m/2)+60,56+p/2),this.NumberArray[d]=f,f.on("touchstart",this.onTouchStart,this),f.on("touchmove",this.onTouchMove,this),f.on("touchcancel",this.onTouchCancel,this),f.on("touchend",this.onTouchEnd,this),f.on("mouseenter",this.onMouseenter,this)}},start:function(){this.plugin.loaded()},initGame:function(){var e=this;this.volumeChamge(this.gameVolume),o.gameErrorTimes=0;var t=o.getRandomArrayElements(this.amountArray,4);t=o.randomArraySort(t),this.DesignArray.forEach(function(e,n){e.getComponent("BlockSpritePrefab").setBlockFrame(t[n],"tuan")}),this.DottedArray.forEach(function(n,o){n.getComponent("BlockSpritePrefab").setIdName(t[o]+1),e.DottedPosArray[t[o]+1]=n.position});var n=o.randomArraySort(t.slice(0));this.NumberArray.forEach(function(t,o){t.getComponent("BlockSpritePrefab").setBlockFrame(n[o],"shuzi"),t.getComponent("BlockSpritePrefab").setIdName(n[o]+1),e.NumberPosArray[n[o]+1]=t.position})},onTouchStart:function(e){this.pos=e.currentTarget.position,o.istouch=!0,cc.log("start ",this.pos),ga.SoundMgr.playFx("audiotuozhuai")},onTouchMove:function(e){var t=e.touch.getDelta();e.currentTarget.getComponent("BlockSpritePrefab").idName;e.currentTarget.x+=t.x,e.currentTarget.y+=t.y},onTouchCancel:function(e){cc.log("cancel");var t=e.currentTarget.getComponent("BlockSpritePrefab").idName;this.NumberPosArray[t]},onTouchEnd:function(e){cc.log("end"),o.istouch=!1;var t=e.currentTarget.getComponent("BlockSpritePrefab").idName,n=this.DottedPosArray[t],i=this.NumberPosArray[t];this.scheduleOnce(function(){n.x==e.currentTarget.x&&n.y==e.currentTarget.y?(ga.SoundMgr.playFx("audioRight"),this.scheduleOnce(function(){this.checkSuccess()},.2),this.plugin.emitAction({type:"success",feature:t})):(e.currentTarget.x=i.x,e.currentTarget.y=i.y,o.gameErrorTimes++,ga.SoundMgr.playFx("audioError"),this.scheduleOnce(function(){ga.SoundMgr.playFx("audiohuiwei")},.2),this.plugin.emitAction({type:"fail",feature:t}))},.2)},onMouseenter:function(e){cc.log("\u64ad\u653e\u6570\u5b57\u97f3\u6548");var t=e.currentTarget.getComponent("BlockSpritePrefab").idName;ga.SoundMgr.playFx(t)},checkSuccess:function(){for(var e=0;e<this.NumberArray.length;e++){var t=this.NumberArray[e],n=this.DottedArray[e];if(t.y!=n.y)return}ga.SoundMgr.playFx("taibangle");0==o.gameErrorTimes||(o.gameErrorTimes>=1&&o.gameErrorTimes<=4||o.gameErrorTimes),this.plugin.gameOver({duration:50,failTime:o.gameErrorTimes})},resumeSE:function(){this.node.resumeSystemEvents(!0)},btnClick:function(e,t){"playBg"==t?ga.SoundMgr.playBgMusic("bgm"):"play1"==t?ga.SoundMgr.playFx("win"):"play2"==t?ga.SoundMgr.playFx("lose"):"startGame"==t&&(this.StartGameLayer.active=!1,ga.SoundMgr.play("yindao1",this.gameVolume),this.plugin.gameStart(),this.node.pauseSystemEvents(!0))},gameRestart:function(){this.initGame()},gamePause:function(){cc.director.pause()},gameResume:function(){cc.director.resume()},volumeChamge:function(e){this.gameVolume=e,ga.SoundMgr.setFxVolume(this.gameVolume),ga.SoundMgr.setFxEffectVolume(this.gameVolume)},gameHint:function(){}}),cc._RF.pop()},{GameUtil:"GameUtil",SoundMgr:"SoundMgr","child-mitt-plugin":"child-mitt-plugin"}],SoundMgr:[function(e,t,n){"use strict";cc._RF.push(t,"f3dbb4qGw5AzYEpsN89TnX/","SoundMgr");var o=function(){},i=null;o.getInstance=function(){return null==i&&(i=new o).init(),i},o.prototype.init=function(){this.sounds={},this.music="",this.enabled=!0;var e=this;cc.loader.loadResDir("sounds",cc.AudioClip,function(t,n){for(var o=0;o<n.length;o++)e.addSound(n[o].name,n[o]),console.log("-------------SoundMgr_music---------",n[o].name),o==n.length-1&&Grobal.mainScene.initGame()})},o.prototype.addSound=function(e,t){this.sounds[e]=t},o.prototype.play=function(e,t){if(t||(t=.5),this.enabled){var n=cc.audioEngine.play(this.sounds[e],!1,t),o=this;"yindao2"==e&&cc.audioEngine.setFinishCallback(n,function(){Grobal.mainScene.resumeSE()}),"yindao1"==e&&(cc.audioEngine.setFinishCallback(n,function(){o.play("yindao2",t)}),console.log("-------------play---------",e))}},o.prototype.setFxVolume=function(e){cc.audioEngine.setVolume(e)},o.prototype.setFxEffectVolume=function(e){cc.audioEngine.setEffectsVolume(e)},o.prototype.playFx=function(e){this.enabled&&(cc.audioEngine.playEffect(this.sounds[e],!1),console.log("-------------playFxMusic---------",e))},o.prototype.playBgMusic=function(e){this.music=e,this.enabled&&(cc.audioEngine.getState(this.audioID)>0||(this.audioID=cc.audioEngine.play(this.sounds[e],!0),console.log("-------------playBgMusic---------",e)))},o.prototype.stopBgMusic=function(){cc.audioEngine.stop()},o.prototype.setEnabled=function(e){this.enabled=e,this.enabled?this.playBgMusic(this.music):cc.audioEngine.stopAll()},o.prototype.getEnable=function(){return this.enabled},t.exports=o,cc._RF.pop()},{}],"child-mitt-plugin":[function(e,t,n){"use strict";cc._RF.push(t,"d65310k7sdOrJvu4UMtahoL","child-mitt-plugin");var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e,i){"object"==(void 0===n?"undefined":o(n))&&"object"==(void 0===t?"undefined":o(t))?t.exports=i():"function"==typeof define&&define.amd?define([],i):"object"==(void 0===n?"undefined":o(n))?n.ChildMittPlugin=i():e.ChildMittPlugin=i()}(window,function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==(void 0===e?"undefined":o(e))&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var i=n(1).default,r=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.onRestart,o=void 0===n?function(){}:n,r=t.onPause,a=void 0===r?function(){}:r,c=t.onResume,u=void 0===c?function(){}:c,s=t.onVolumeChange,l=void 0===s?function(){}:s,d=t.onHint,f=void 0===d?function(){}:d,m=t.onInit,p=void 0===m?function(){}:m;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),i.init(),i.on("child:restart",function(){o()}),i.on("child:pause",function(){a()}),i.on("child:resume",function(){u()}),i.on("child:volume-change",function(e){l(e.data)}),i.on("child:hint",function(){f()}),i.on("child:init",function(e){p(e.data)})}var t,n;return t=e,(n=[{key:"loaded",value:function(){i.emit("parent:loaded",{targetOrigin:"*"})}},{key:"emitAction",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i.emit("parent:action",{message:{type:e.type,feature:e.feature},targetOrigin:"*"})}},{key:"gameStart",value:function(){i.emit("parent:game-start",{targetOrigin:"*"})}},{key:"gameOver",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i.emit("parent:game-over",{message:{duration:e.duration,failTime:e.failTime},targetOrigin:"*"})}}])&&o(t.prototype,n),e}();e.exports=r},function(e,t,n){n.r(t);function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}n.d(t,"default",function(){return r});var i=function(e){return e=e||Object.create(null),{on:function(t,n){(e[t]||(e[t]=[])).push(n)},off:function(t,n){e[t]&&e[t].splice(e[t].indexOf(n)>>>0,1)},emit:function(t,n){(e[t]||[]).slice().map(function(e){e(n)}),(e["*"]||[]).slice().map(function(e){e(t,n)})}}}(),r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,n=[{key:"init",value:function(){window.addEventListener("message",function(e){if(e.data&&e.data.type){var t={data:e.data.message,origin:e.origin,source:e.source};i.emit(e.data.type,t)}}),this.postMessage({type:"iframe_mitt:ready",data:"ready"},"*"),window.console.info("iframe mitt ready")}},{key:"postMessage",value:function(e,t,n){window.parent&&window.parent.postMessage(e,t,n)}},{key:"emit",value:function(e,t){var n=t.message,o=t.targetOrigin,i=t.transfer,r={type:e,message:n};this.postMessage(r,o,i)}},{key:"on",value:function(e,t){i.on(e,t)}},{key:"off",value:function(e,t){i.off(e,t)}}],null&&o(t.prototype,null),n&&o(t,n),e}()}])}),cc._RF.pop()},{}],soundCtrl:[function(e,t,n){"use strict";cc._RF.push(t,"31048UA4MVPKaYD7ZjkmSQ9","soundCtrl"),cc.Class({extends:cc.Component,properties:{onImg:cc.SpriteFrame,offImg:cc.SpriteFrame,isPlay:{default:!0,notify:function(){this._updateSoundImg()}}},onEnable:function(){this.isPlay=ga.SoundMgr.getEnable()},_updateSoundImg:function(){this.isPlay?this.node.getComponent(cc.Sprite).spriteFrame=this.onImg:this.node.getComponent(cc.Sprite).spriteFrame=this.offImg},changeSound:function(){this.isPlay?(ga.SoundMgr.setEnabled(!1),cc.log("\u97f3\u4e50\u6682\u505c")):(ga.SoundMgr.setEnabled(!0),cc.log("\u97f3\u4e50\u7ee7\u7eed")),this.isPlay=ga.SoundMgr.getEnable()}}),cc._RF.pop()},{}]},{},["Grobal","SoundMgr","soundCtrl","LoadingLayer","MainScene","BlockSpritePrefab","child-mitt-plugin","GameUtil"]);